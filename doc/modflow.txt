


modflow(1)       U.S. Geological Survey (wrdapp)       modflow(1)


NAME
       modflow - Modular three-dimensional finite-difference ground-water
                 flow model

ABSTRACT
       MODFLOW is a three-dimensional finite-difference ground-water flow
       model.  It has a modular structure that allows it to be easily
       modified to adapt the code for a particular application.  Many new
       capabilities have been added to the original model.  This version
       includes all the major capabilities that were documented as of
       September 1996.

       MODFLOW simulates steady and nonsteady flow in an irregularly shaped
       flow system in which aquifer layers can be confined, unconfined, or
       a combination of confined and unconfined.  Flow from external
       stresses, such as flow to wells, areal recharge, evapotranspiration,
       flow to drains, and flow through river beds, can be simulated.
       Hydraulic conductivities or transmissivities for any layer may
       differ spatially and be anisotropic (restricted to having the
       principal direction aligned with the grid axes and the anisotropy
       ratio between horizontal coordinate directions is fixed in any one
       layer), and the storage coefficient may be heterogeneous.  The model
       requires input of the ratio of vertical hydraulic conductivity to
       distance between vertically adjacent block centers.  Specified head
       and specified flux boundaries can be simulated as can a head
       dependent flux across the model's outer boundary that allows water
       to be supplied to a boundary block in the modeled area at a rate
       proportional to the current head difference between a "source" of
       water outside the modeled area and the boundary block.  MODFLOW is
       currently the most used numerical model in the U.S. Geological
       Survey for ground-water flow problems.  An efficient contouring
       program is available (Harbaugh, 1990) to visualize heads and
       drawdowns output by the model.

METHOD
       The ground-water flow equation is solved using the finite-difference
       approximation.  The flow region is considered to be subdivided into
       blocks in which the medium properties are assumed to be uniform.
       The plan view rectangular discretization results from a grid of
       mutually perpendicular lines that may be variably spaced.  The
       vertical direction zones of varying thickness are transformed into a
       set of parallel "layers".  Several solvers are provided for solving
       the associated matrix problem; the user can choose the best solver
       for the particular problem.  Mass balances are computed for each
       time step and as a cumulative volume from each source and type of
       discharge.

HISTORY
       Version 2.6 1996/09/20 - Added Reservoir package (RES1) as
          documented in U.S. Geological Survey Open-File Report 96-364.
          Problem fixed for IBS package.  Although subsidence is only meant
          to be active for layers in which IBQ>0, sometimes MODFLOW
          performed subsidence calculations when IBQ<0.  Note that this was
          a problem only if negative IBQ values were specified.  That is,



                           22 May 1997                          1





modflow(1)       U.S. Geological Survey (wrdapp)       modflow(1)


          the code has always worked correctly for IBQ=0 and IBQ>0.

       Version 2.5 1995/06/23 - Added direct solution package (DE45).

       Version 2.4 1995/06/15 - Added transient leakage package (TLK1).

       Version 93/08/30 - Release with PCG2, BCF3, STR1, HFB1, ISB1, CHD1,
          and GFD1 additions.

       Version 87/07/24 - Fortran 77 version published in U.S. Geological
          Survey Techniques of Water-Resources Investigations 6-A1.

       Version 83/12/28 - Fortran 66 version published in U.S. Geological
          Survey Open-File Report 83-875.

DATA REQUIREMENTS
       In order to use MODFLOW, initial conditions, hydraulic properties,
       and stresses must be specified for every model cell in the finite-
       difference grid.

OUTPUT OPTIONS
       Primary output is head, which can be written to the listing file or
       into a separate file.  Other output includes the complete listing of
       all input data, drawdown, and budget data.  Budget data are printed
       as a summary in the listing file, and detailed budget data for all
       model cells can be written into a separate file.

SYSTEM REQUIREMENTS
       MODFLOW-88 is written in Fortran 77 with the following extensions:
       use of variable names longer than 6 characters and the
       CARRIAGECONTROL option in OPEN statements.  By default, the software
       is dimensioned for use with models having up to 90,000 cells.
       MODFLOW-88 uses preallocated files, which means that the file names
       are not assigned by Fortran OPEN statements.  Instead, the compiler
       or operating system must provide a way to open the files.  Example
       script files are provided to illustrate this procedure.  Generally,
       the program is easily installed on most computer systems.  The code
       has been used on UNIX-based computers and DOS-based 386 or greater
       computers having a math coprocessor and 4 mb of memory.

PACKAGES
       This version of MODFLOW includes the following packages:

           BAS1 -- Basic Package
           BCF3 -- Version 3 of Block-Centered Flow Package
           RIV1 -- River Package
           DRN1 -- Drain Package
           WEL1 -- Well Package
           GHB1 -- General Head Boundary Package
           RCH1 -- Recharge Package
           EVT1 -- Evapotranspiration Package
           SIP1 -- Strongly Implicit Procedure Package
           SOR1 -- Slice Successive Over-Relaxation Package
           UTL1 -- Utility Package



                           22 May 1997                          2





modflow(1)       U.S. Geological Survey (wrdapp)       modflow(1)


           PCG2 -- Version 2 of Preconditioned Conjugate Gradient Package
           STR1 -- Stream Package
           IBS1 -- Interbed-Storage Package
           CHD1 -- Time-Variant Specified-Head Package
           GFD1 -- General Finite Difference Flow Package
           HFB1 -- Horizontal Flow Barrier Package
           TLK1 -- Transient Leakage Package
           DE45 -- Direct solver
           RES1 -- Reservoir Package

       The user must specify values for the appropriate IUNIT array element
       to include packages not in the original model.  The IUNIT array is
       interpreted according to the following table:

           BCF3 -- IUNIT(1) -- same IUNIT as used for BCF1 because BCF3
       replaces BCF1
           TLK1 -- IUNIT(6)
           DE45 -- IUNIT(10)
           PCG2 -- IUNIT(13)
           GFD1 -- IUNIT(14)
           HFB1 -- IUNIT(16)
           RES1 -- IUNIT(17)
           STR1 -- IUNIT(18)
           IBS1 -- IUNIT(19)
           CHD1 -- IUNIT(20)

       The input unit for the Basic Package is unit 5, which is defined by
       the assignment of variable INBAS in the MAIN program.

DEPENDENCIES AMONG PACKAGES
       As documented in Open-File Report (OFR) 94-59, the Transient Leakage
       (TLK) Package does not simulate flow through a confining unit at any
       horizontal grid location at which a cell on either side of the
       confining unit is dry.  When this situation occurs as a result of
       initial conditions, the user can determine if this is appropriate
       before making a simulation.  However, a cell can go dry at any time
       during a simulation when using the water-table or convertible layer
       options in the Block-Centered Flow (BCF) Package.  When a cell goes
       dry on either side of a confining unit, the transient leakage
       through the confining unit immediately becomes zero at that
       horizontal location.  Users should check simulations to see if cells
       on either side of a confining unit are going dry at any time during
       a simulation and determine if it is acceptable for the transient
       leakage to switch to zero.  Further complications can result when
       using the wetting capabilities of version 2 of the BCF Package.  If
       dry cells convert to wet so that cells on both sides of a confining
       unit are wet, then transient leakage calculations will be started;
       however, the equations will not be properly formulated to simulate
       the previous conditions, so the transient flow will not be correct.
       Thus, the wetting capability should not be used for any model layers
       that connect to a confining unit that is being simulated with the
       TLK Package.

       The Time-Variant Specified-Head (CHD) Package can potentially cause



                           22 May 1997                          3





modflow(1)       U.S. Geological Survey (wrdapp)       modflow(1)


       the TLK Package to operate incorrectly if the CHD Package is being
       used to specify constant heads at cells on either side of a
       confining unit.  The TLK Package relies on initial head as defined
       by the Basic Package to setup initial parameters.  If the data for
       the CHD Package define initial heads (i.e., head for the first time
       step of the simulation) on either side of a confining unit to be
       different than defined by the Basic Package, the transient leakage
       calculations will be incorrect.  To avoid this conflict, do not use
       the CHD Package to define constant head cells on either side of a
       confining unit, or be sure that the initial head in the Basic
       Package exactly matches the initial head defined by the CHD Package.

DOCUMENTATION
       McDonald, M.G., and Harbaugh, A.W., 1988, A modular three-
          dimensional finite-difference ground-water flow model: U.S.
          Geological Survey Techniques of Water-Resources Investigations,
          book 6, chap. A1, 586 p.

       Version 2 of Preconditioned Conjugate Gradient Package is documented
       in:

       Hill, M.C., 1990, Preconditioned conjugate-gradient 2 (PCG2), a
          computer program for solving ground-water flow equations: U.S.
          Geological Survey Water-Resources Investigations Report 90-4048,
          43 p.

       The Stream Package is documented in:

       Prudic, D.E., 1989, Documentation of a computer program to simulate
          stream-aquifer relations using a modular, finite-difference,
          ground-water flow model: U.S. Geological Survey Open-File Report
          88-729, 113 p.

       The Interbed-Storage and Time-Variant Specified-Head Packages are
       documented in:

       Leake, S.A., and Prudic, D.E., 1988, Documentation of a computer
          program to simulate aquifer-system compaction using the modular
          finite-difference ground-water flow model: U.S. Geological Survey
          Open-File Report 88-482, 80 p.

       The General Finite Difference Flow Package is documented in:

       Harbaugh, A.W., 1992, A generalized finite-difference formulation
          for the U.S. Geological Survey modular three-dimensional finite-
          difference ground-water flow model: U.S. Geological Survey Open-
          File Report 91-494, 60 p.

       The Version 2 of the Block-Centered Flow Package is documented in:

       McDonald, M.G., Harbaugh, A.W., Orr, B.R., and Ackerman, D.J., 1992,
          A method of converting no-flow cells to variable-head cells for
          the U.S. Geological Survey modular finite-difference ground-water
          flow model: U.S. Geological Survey Open-File Report 91-536, 99 p.



                           22 May 1997                          4





modflow(1)       U.S. Geological Survey (wrdapp)       modflow(1)


       The BCF3 Package is documented in three pieces.  It builds on two
       previous versions of the Block-Centered Flow (BCF) Package.
       Documentation for the BCF1 Package describes the fundamental
       function of all BCF Packages.  This documentation is contained in
       the basic model documentation (McDonald and Harbaugh, 1988).  BCF2
       documentation describes the addition of the capability to convert
       dry cells to wet:

       McDonald, M.G., Harbaugh, A.W., Orr, B.R., and Ackerman, D.J., 1992,
          A method of converting no-flow cells to variable-head cells for
          the U.S. Geological Survey modular finite-difference ground-water
          flow model: U.S. Geological Survey Open-File Report 91-536, 99 p.

       BCF3 documentation describes the addition of alternate interblock
       transmissivities.  The BCF3 code includes the capabilities of BCF1
       and BCF2:

       Goode, D.J., and Appel, C.E., 1992, Finite-difference interblock
          transmissivity for unconfined aquifers and for aquifers having
          smoothly varying transmissivity: U.S. Geological Survey Water-
          Resources Investigations Report 92-4124, 79 p.

       The HFB1 Package is documented in:

       Hsieh, P.A., and Freckleton, J.R., 1993, Documentation of a computer
          program to simulate horizontal-flow barriers using the U.S.
          Geological Survey modular three-dimensional finite-difference
          ground-water flow model: U.S.  Geological Survey Open-File Report
          92-477, 32 p.

       The Transient-Leakage Package (TLK1) is documented in:

       Leake, S.A., Leahy, P.P., and Navoy, A.S., 1994, Documentation of a
          computer program to simulate transient leakage from confining
          units using the modular finite-difference ground-water flow
          model: U.S. Geological Survey Open-File Report 94-59, 70 p.

       The DE45 Package is documented in:

       Harbaugh, A.W., 1995, Direct solution package based on alternating
          diagonal ordering for the U.S. Geological Survey modular finite-
          difference ground-water flow model: U.S. Geological Survey Open-
          File Report 95-288, 46 p.

       The RES1 Package is documented in:

       Fenske, J.P., Leake, S.A., and Prudic, D.E., 1996, Documentation of
          a computer program (RES1) to simulate leakage from reservoirs
          using the modular finite-difference ground-water flow model
          (MODFLOW): U.S. Geological Survey Open-File Report 96-364, 51 p.

RELATED DOCUMENTATION
       Harbaugh, A.W., 1990, A simple contouring program for gridded data:
          U.S. Geological Survey Open-File Report 90-144, 37 p.



                           22 May 1997                          5





modflow(1)       U.S. Geological Survey (wrdapp)       modflow(1)


REFERENCES
       MODFLOW is widely used in the USGS and throughout the world.

       Belitz, K., and Phillips, S.P., 1993, Numerical simulation of
          ground-water flow in the central part of the western San Joaquin
          Valley, California: U.S. Geological Survey Water-Supply Paper
          2396, 69 p.

       Prince, K.R., Franke, O.L., and Reilly, T.E., 1988, Quantitative
          assessment of the shallow ground-water flow system associated
          with Connetquot Brook, Long Island, New York: U.S. Geological
          Survey Water-Supply Paper 2309, 28 p.

TRAINING
       Modeling of Ground-Water Flow Using Finite-Difference Methods
       (GW2096TC), offered annually at the USGS National Training Center.

       Advanced Finite-Difference Modeling of Ground-Water Flow (GW3099TC),
       offered annually at the USGS National Training Center.

CONTACTS
       Operation:
          U.S. Geological Survey
          Office of Ground Water
          Arlen Harbaugh
          411 National Center
          Reston, VA 20192

          harbaugh@usgs.gov

       Distribution:
          U.S. Geological Survey
          Hydrologic Analysis Software Support Team
          David Boldt
          437 National Center
          Reston, VA 20192

          h2osoft@usgs.gov

       Official versions of U.S. Geological Survey water-resources analysis
       software are available for electronic retrieval via the World Wide
       Web (WWW) at:

                  http://water.usgs.gov/software/

       and via anonymous File Transfer Protocol (FTP) from:

                  water.usgs.gov (path: /pub/software).

       The WWW page and anonymous FTP directory from which the MODFLOW
       software can be retrieved are, respectively:

                  http://water.usgs.gov/software/modflow.html
                                --and--



                           22 May 1997                          6





modflow(1)       U.S. Geological Survey (wrdapp)       modflow(1)


                  /pub/software/ground_water/modflow

       If you would like to obtain the price of and (or) order paper copies
       of USGS reports, contact the USGS Branch of Information Services at:

                  U.S. Geological Survey
                  Branch of Information Services
                  Denver Federal Center, Box 25286
                  Denver CO 80225-0286

       To inquire about Open-File Reports or Water-Resources Investigations
       Reports:
                  Tel: 303-202-4210; Fax 303-202-4695

       To inquire about other USGS reports:
                  Tel: 303-202-4700; Fax 303-202-4693

SEE ALSO
       contour(1) - A contouring program for gridded data
       mmsp - Modular Model Statistical Processor
       moc(1) - Two-dimensional method-of-characteristics
                ground-water flow and transport model
       modfe(1) - Modular finite-element model for areal and
                  axisymmetric ground-water flow problems
       Modflowp(1) - Parameter-estimation version of the modular model
       modpath(1) - Particle-tracking postprocessor program for
                    the modular three-dimensional finite-difference
                    ground-water flow model
       sutra(1) - Saturated and (or) unsaturated, constant or
                  variable-density fluid flow, and solute or energy
                  transport (2-dimensional finite-element code)
       vs2dt(1) - Model for simulating water flow and solute
                  transport in variably saturated porous media
























                           22 May 1997                          7


