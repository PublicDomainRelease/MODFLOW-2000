RELEASE.TXT

                           MODFLOW-2000 Release Notes

     This file describes changes introduced into MODFLOW-2000 with each
official release; these changes may substantially affect users.  Changes to
the post-processing programs RESAN-2000, YCINT-2000, and BEALE-2000 also are
described.  In this file, packages and processes are referred to by their 3-
or 4-character abbreviation.  For information and references related to
these packages and processes, see mf2k.txt ("Summary of MODFLOW-2000").

NOTE: Any use of trade, product or firm names is for descriptive purposes 
      only and does not imply endorsement by the U.S. Government.

o Version 1.7 12/04/2001:

     Time-varying parameters are introduced with this version.  Most
packages that read input each stress period support time-varying parameters.
These include both list-type packages such as RIV and STR and array-type
packages such as RCH and EVT.  Time-varying parameters are useful when the
user desires to estimate one parameter but vary properties included in the
parameter definition from one stress period to another.  In the RIV Package
for example, a parameter may be defined to control riverbed conductance at a
group of model cells throughout a simulation, and multiple user-defined
"instances" associated with that parameter may be used to specify a series
of values for river stage for different stress periods in the simulation.
See files Time-varying-parameters.pdf and str6.pdf in the doc directory for
details.

     The start time, end time, and elapsed time required to execute
MODFLOW-2000 are now written to the screen.  These times also can be written
to the global output file by specifying "PRINTTIME" as an option in Item 1
of the BAS Package input file.  When the program is used in batch mode,
these times are determined and written for each simulation, that is, for
each name file listed in modflow.bf.  This capability is expected to be
particularly useful in evaluating performance of the program in different
serial- and parallel-processing environments.

     Fixed problem where, when using parallel processing, files of type
DATA, DATA(BINARY), DATAGLO, and DATAGLO(BINARY) may not be opened correctly
for MPI processes other than the master process.  This version uses the name
file options described for version 1.6 below to determine the correct method
for opening files of these types.  To correctly generate output files of
these types, use the "REPLACE" option.  The "OLD" option may be used to
designate input files.

     Output related to observations of flow at constant-head boundaries no
longer refers (mistakenly) to the "Constant-Head Boundary Package."

o Version 1.6 10/19/2001:

     New options for the name file allow users to designate files of type
DATA, DATA(BINARY), DATAGLO, or DATAGLO(BINARY) as either input or output
files.  One of the options (either "OLD" for an input file or "REPLACE" for
an output file) may be placed after the file name on the line listing the
file type, unit number, and file name.  If "OLD" is specified, the file must
exist when the program is started.  If "REPLACE" is specified and the file
exists when the program is started, the existing file is deleted, then
opened.  The status of each file ("OLD", "REPLACE", or "UNKNOWN") is now
shown in the global output file.  Note that the "OLD" or "REPLACE" option is
not required.  If neither is listed, the file status is shown as "UNKNOWN"
and program execution continues normally.  When output to a BINARY file from
an earlier model run exceeds the amount of output generated by the current
model run, specifying "REPLACE" may be required to ensure the file does not
include output from the previous run after the output generated by the
current run.  The options may be entered in any combination of uppercase and
lowercase letters.

     This version fixes a bug that caused simulation time to be truncated,
for runs that involve calculation of sensitivities, to a simulation period
one time step too short when the last flow observation in a transient
simulation falls in a later time step than the final head observation.

     Corrected problem that caused observation sensitivities for
constant-head flow observations to be incorrect for log-transformed
parameters.

     STR6 documentation (str6.pdf) was modified to clarify the format for
STR input.

     ADV2 was updated to fix a problem in the calculation of particles
released to weak sinks.  In addition, a change was made in the reading of
the WTQ array.  See adv.txt for the modified format required to input the
WTQ array.

o Version 1.5 08/16/2001:

     The LMT Package was added -- it adds support for generating a link
file to be read by the contaminant-transport program MT3DMS (see
<http://hydro.geo.ua.edu/mt3d/>).

     Fixed bug that caused interpolation to be incorrect for a head
observation that occurs before the end of the first time step of an initial
transient stress period.

     LMG was revised to work without causing program to bomb when using
parallel processing.

     Fixed bug where divide-by-zero error would occur if using parallel
processing with more than one MPI process and one parameter is being
estimated.

     Hydfmt and hydpost were revised to enable them to read the binary files 
generated by MODFLOW-2000 beginning with version 1.2.

o Version 1.4 07/10/2001:

     A new solver package, the LMG (Link-AMG) Package, was added.  LMG
provides a link to the Algebraic Multi-Grid (AMG) solver.

     A problem related to RMAR of the Parameter-Estimation (PES) Process
input file was fixed.  Prior to the fix, RMAR was set to 0.001 regardless of
the value entered in the PES input file.  Output describing RMAR, which is
written to the global file, was corrected.

     Support for the use of the tab character as a separator in free-format
input was added.

     YCINT2K was modified to correct an error in calculated confidence
intervals.  Previously, the variance of the measurement error expected for
prediction was incorrectly included in the calculation of confidence
intervals.

o Version 1.3 06/11/2001:

     Fixed problem in LPF where if a lower cell goes dry while the cell above
is still wet, there is a non-zero vertical conductance to a dry cell, causing
calculated heads and flows to be in error.

     Fixed problem in PCG2 that caused tables of maximum head and residual
changes each iteration to be printed when MUTPCG is set to 1.

     Fixed bug in modified Gauss-Newton routine PES1GAU1AP that caused
divide-by-zero error when a sensitivity equals zero.

     Support for printing of auxiliary variables was increased from 2 to 5
auxiliary variables.

     Added support for calculation of approximate sensitivities for STR
parameters when ICALC of the STR Package is > 0.  The formulation relies on
the assumption that the dependence of the stream stage on SFR parameter
values is negligible.  In most cases, the error introduced by this
assumption is small and the sensitivities can be used for parameter
estimation.  If the user does not feel that this assumption is justifiable,
the use of UCODE (Poeter, E.P., and Hill, M.C., 1998, Documentation of
UCODE, a computer code for universal inverse modeling: U.S. Geological
Survey Water-Resources Investigations Report 98-4080, 116 p.) is
recommended.

     Fixed bug that caused sensitivities of STR-Package flow observations to
STR parameters to be incorrectly calculated in some cases.

     The ADV Package was modified to fix a problem with tracking through
confining layers.  The problem occured when observation times or
particle-tracking time step (ADVSTP) times were reached when the particle
was within a confining unit, the subsequent tracking was incorrect.

     The HUF Package was modified to fix a number of bugs.  Updated the way
flow between constant-head cells are calculated to correspond to the
equivalent calculation in the LPF Package.

     Messages printed when STAT-FLAG for a prior-information equation is
invalid were reworded to improve clarity.

     Several bug(s) related to parallel processing were fixed.

     Corrected output of calculated error variance (variable VAR) to _b1
files.  BEALE2K was modified to read the revised format of _b1 files.

     MFPTO2K was corrected to correctly account for common error variance
(variable EV of MODFLOWP input data set 5) values other than 1.0, and to
account for numbers of time steps and stress periods correctly.

o Version 1.2 04/12/2001:

     The program was modified to support the use of non-standard
options in OPEN statements for unformatted files. This is useful on
personal computers because it makes it possible to use different
compilers and still have MODFLOW produce unformatted files with the
same structure.  When standard Fortran is used, different compilers
result in unformatted files that have different structures. In
MODFLOW-2000, the files affected are those listed in the name file with
file type DATA(BINARY) or DATAGLO(BINARY) and those referenced in
array-control records for the array-reading utility modules U2DINT and
U2DREL where FMTIN is specified as "(BINARY)".  The include file
openspec.inc (in the \src\mf2k\ directory in the MODFLOW-2000
distribution) describes the specifiers for the OPEN statement that can
be modified.

     The runfile distributed by the USGS for use on personal computers
uses options in the OPEN statement that cause the structure of
unformatted files to be different than what was used in previous
versions of the runfile.  The new files are referred to as
"unstructured" because they eliminate the vendor-specific structure
normally included in such files.

     Programs that will read unformatted files produced by the USGS
distributed MODFLOW-2000 runfile will need to be modified to read
unstructured, unformatted files (using OPEN-statement specifiers and
options appropriate for the compiler being used) and recompiled. 
Updated versions of ZONEBUDGET and MODPATH that read the new
unstructured unformatted files are being released concurrently with
this new release of MODFLOW.

     The calculation of dimensionless scaled sensitivities (DSS) for
log-transformed parameters was modified.  Previously, DSS was calculated as
X*B*(WT**0.5)*abs(ln(B)), where X is the sensitivity of the observation to
the native parameter value, B is the parameter value, WT is the weight
associated with an observation, abs() is the absolute-value function, and
ln() is the natural logarithm function.  Now, DSS is calculated as
X*B*(WT**0.5).  The revised formula allows DSS and composite scaled
sensitivity (CSS) values to be the same whether a parameter is
log-transformed or not.  This change also eliminates the problem that for
log-transformed parameters with a value of 1.0, DSS and CSS would be listed
as 0.0.

     The format of _rs files generated when OUTNAM is not 'NONE' was changed
to provide more significant figures for values passed to RESAN2K.  RESAN2K
was similarly changed to read the new format of _rs files.

     Fixed bug in RESAN2K that caused incorrect results when
prior-information equations were used.

     Fixed bug in LPF Package that caused incorrect results when VKCB
parameters are used and a layer without a confining bed overlies a layer with
a confining bed.

     Fixed two bugs in parallel-processing capability.  The first bug caused
the program to fail occasionally and inconsistently.  The second caused
incorrect values of solver discrepancy to be output to the global file in
some circumstances.

     Fixed bug that caused program to fail or produce incorrect results when
ISENS > 0 for a single, non-log-transformed parameter.

     Fixed bug in HFB Package that caused program to generate zero
sensitivities for HFB parameters in some circumstances.  This bug would have
had unpredictable, incorrect results for sensitivities when nonparameterized
flow barriers were specified.

     Revised format of table of smallest and largest weighted residuals to
list percent contribution to the sum of squared, weighted residuals
objective function.  This table now may include residuals related to prior
information.

     Clarified messages written to LIST file when head observations are
omitted because IBOUND=0 at cell(s) required for interpolation.

     Corrected problem related to cases where a prior-information equation
is for a log-transformed parameter and STAT-FLAG indicates that STAT is a
coefficient of variation.  Previously, the weight was not being calculated
correctly in this situation.

     Output related to prior information was clarified.  Fixed bug that
caused printed unweighted measured, calculated, and residual values for
correlated prior information to be incorrect.

     Made change to allow user, when prompted to enter a name file
interactively, to enter either the full name file name or just the base
name, to which ".nam" will be added when the program tries to find the name
file.

     ADV Package was changed to fix a problem related to tracking a particle
through a confining bed.

     Fixed bug that caused error when LASTX (in PES file) was specified > 0.

     Fixed bug that caused RMAR (in PES file) to be ignored.

     Fixed bug that caused _rs file to contain incorrect parameter number
for parameters with correlated prior information in certain circumstances.

     If a parameter definition for a list-type parameter does not include at
least one cell, the program now stops with an error message.

     Moved printing of ordered residuals from GLOBAL file to LIST file.

     Modified program to allow it to run in batch mode successfully even if
parameter estimation fails to converge for one of the data sets.

     Array dimensions in RESAN-2000 were increased to allow up to 500
parameters, 10,000 observations (total), 500 flow observations, 100
prior-information equations, and 100 parameters with correlated prior
information.

     BEALE-2000 was changed to correctly write names of observations other
than head observations.  Array dimensions were increased to allow up to
10,000 observations (total), 10,000 head observations, 500 parameters.

o Version 1.1 01/17/2001:

     Added IBS, HUF, LAK, ETS, and DRT Packages.  Added HYDMOD option.  The
EVT Package was modified as described in the LAK documentation to include
the option (NEVTOP=3) to apply ET to the uppermost wet cell in a vertical
column of cells as done in the RCH Package.

     Added support for generation of an output file with the extension _pc
when OUTNAM is not 'NONE', the Parameter-Estimation Process is active, and
parameter estimation converges.  This file contains a record for each
estimated parameter listing: parameter name, LN, optimized parameter value,
BL, BU, lower 95-percent confidence limit on the parameter value, and upper
95-percent confidence limit on the parameter value.

     Fixed bug that incorrectly allowed substantial parameter changes in
some circumstances when MAX-ITER was specified as 0 in the PES input file.
An effect of this fix is that if MAX-CHANGE is specified as a value smaller
than 0.4, the MAX-CHANGE (used) value never differs from MAX-CHANGE.

     Fixed bugs related to writing of _ww and _ws files.  Previously,
incorrect values were written for weighted observed and weighted simulated
values for flow observations. 

     Fixed bug that caused MODFLOW-2000 to incorrectly stop with an error
message when constant-head flow observations were specified and the GHB
Package was inactive.

     Fixed problem where incorrect values of BL and BU were written to the
GLOBAL file under some circumstances.

     Increased the maximum number of allowed parameters from 40 to 500.

     Eliminated 1000-observation limit.  Now the number of observations and
prior-information equations are not limited by the program.

     Changed the file-type identifier required in the name file to activate
the ADV Package from ADV to ADV2.

     The directory structure was changed to put para-non.f into the
\src\mf2k\serial\ directory and para-mpi.f into the \src\mf2k\parallel\
directory.

o Version 1.0 07/20/2000:

     Initial release of MODFLOW-2000, RESAN-2000, YCINT-2000, and
BEALE-2000.

